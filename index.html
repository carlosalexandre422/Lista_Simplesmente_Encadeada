<!DOCTYPE html>
<html>
<head>
  <title>Lista Simplesmente Encadeada</title>
  <style>
    body {
      background-color: #d8eaff;
      font-family: Roboto;
      display: flex;
    }
    .container {
      margin: 20px;
    }
    .list-container {
      display: flex;
      flex-direction: row;
      align-items: center;
      flex-wrap: wrap;
    }
    .list-item {
      display: inline-block;
      margin-right: 10px;
      margin-bottom: 10px;
      background-color: #6692af;
      color: white;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 16px;
      transition: all 0.3s;
    }
    button:hover, .list-item:hover {
      background-color: #455c6d;
    }
    .arrow {
      color: #204158;
      width: 20px;
      height: 20px;
      margin: 0 10px;
    }

    button{
      background-color: #3498db;
      color: white;
      padding: 5px 10px;
      border-radius: 5px;
      border: none;
      margin-right: 10px;
      margin-bottom: 5px;
      transition: all 0.3s;
      font-size: 16px;
      cursor: pointer;
    }
    h2{
      color: #204158;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Lista Simplesmente Encadeada</h2>
    <button onclick="inserirElemento()">Inserir Elemento</button>    
    <button onclick="inserirInicio()">Inserir Início</button>
    <button onclick="inserirFinal()">Inserir Final</button>
    <br><br>    
    <button onclick="removerElemento()">Remover Elemento</button>
    <button onclick="removerInicio()">Remover Início</button>
    <button onclick="removerFinal()">Remover Final</button>
    <br><br>    
    <button onclick="consultarPorValor()">Consultar por Valor</button>
    <button onclick="consultarPorPosicao()">Consultar por Posição</button>
    <br><br><br>
    <div class="list-container" id="listContainer">
      <!-- Lista será exibida aqui -->
    </div>
  </div>

  <script>
    class No {
      constructor() {
        this.conteudo = 0;
        this.prox = null;
      }

      getConteudo() {
        return this.conteudo;
      }

      setConteudo(valor) {
        this.conteudo = valor;
      }

      getProx() {
        return this.prox;
      }

      setProx(proximoNo) {
        this.prox = proximoNo;
      }
    }

    class LSE {
      constructor() {
        this.cabeca = null;
        this.nElementos = 0;
      }

      vazia() {
        return this.nElementos === 0;
      }

      tamanho() {
        let aux = this.cabeca;
        let cont = 0;
        while (aux !== null) {
          aux = aux.getProx();
          cont++;
        }
        return cont;
      }

      elemento(pos) {
        if (this.vazia()) {
          alert('Lista vazia.')
          return -1;
        }

        if (pos < 1 || pos > this.tamanho() || isNaN(pos)) {
          alert('Posição inválida.')
          return -1;
        }

        let aux = this.cabeca;
        for (let i = 1; i < pos; i++) {
          aux = aux.getProx();
        }

        return aux.getConteudo();
      }

      posicao(dado) {
        if (this.vazia()) {
          alert('Lista vazia.');
          return -1;
        }
        if (isNaN(dado)) {
          alert('Valor inválido.');
          return -1;
        }

        let aux = this.cabeca;
        let cont = 1;
        while (aux !== null) {
          if (aux.getConteudo() === dado) {
            return cont;
          }
          aux = aux.getProx();
          cont++;
        }
        alert('Valor não encontrado na lista.');
        return -1;
      }

      insereInicioLista(valor) {
        if(isNaN(valor)){
          alert('Valor inválido.');
          return false;
        }
        let novoNo = new No();
        novoNo.setConteudo(valor);
        novoNo.setProx(this.cabeca);
        this.cabeca = novoNo;
        this.nElementos++;
        return true;
      }

      insereMeioLista(pos, valor) {
        let novoNo = new No();
        novoNo.setConteudo(valor);

        let aux = this.cabeca;
        for (let i = 1; i < pos - 1; i++) {
          aux = aux.getProx();
        }

        novoNo.setProx(aux.getProx());
        aux.setProx(novoNo);

        this.nElementos++;
        return true;
      }
      insereFimLista(valor) {
        if(isNaN(valor)){
          alert('Valor inválido.')
          return false;
        }

        let novoNo = new No();
        novoNo.setConteudo(valor);

        if (this.vazia()) {
          this.cabeca = novoNo;
        } else {
          let aux = this.cabeca;
          while (aux.getProx() !== null) {
            aux = aux.getProx();
          }
          aux.setProx(novoNo);
        }

        this.nElementos++;
        return true;
      }

      insere(pos, valor) {
        if (this.vazia() && pos !== 1) {
          alert('Lista vazia. Insira na posição 1.');
          return false;
        }

        if (pos <= 0 || pos > this.nElementos + 1 || isNaN(pos)) {
          alert('Posição inválida.');
          return false;
        }

        if (isNaN(valor)) {
          alert('Valor inválido.');
          return false;
        }

        if (pos === 1) {
          return this.insereInicioLista(valor);
        } else {
          return this.insereMeioLista(pos, valor);
        }
      }

      removeInicioLista() {
        if(lista.vazia()){
          alert('A lista está vazia.')
          return -1;
        }
        let p = this.cabeca;
        let valorRemovido = p.getConteudo();
        this.cabeca = p.getProx();
        this.nElementos--;
        p = null;
        return valorRemovido;
      }

      removeNaLista(pos) {
        let antecessor = this.cabeca;
        for (let i = 1; i < pos - 1; i++) {
          antecessor = antecessor.getProx();
        }
        let atual = antecessor.getProx();
        let valorRemovido = atual.getConteudo();
        antecessor.setProx(atual.getProx());
        this.nElementos--;
        atual = null;
        return valorRemovido;
      }

      removeFimLista() {
        if (this.vazia()) {
          alert('A lista está vazia.')
          return -1;
        }

        let antecessor = null;
        let atual = this.cabeca;
        while (atual.getProx() !== null) {
          antecessor = atual;
          atual = atual.getProx();
        }

        let valorRemovido = atual.getConteudo();
        if (antecessor === null) {
          this.cabeca = null;
        } else {
          antecessor.setProx(null);
        }

        this.nElementos--;
        atual = null;
        return valorRemovido;
      }

      remove(pos) {
        if (this.vazia()) {
          alert('A lista está vazia.')
          return -1;
        }

        if (pos <= 0 || pos > this.nElementos || isNaN(pos)) {
          alert('Posição inválida.')
          return -1;
        }

        if (pos === 1) {
          return this.removeInicioLista();
        } else {
          return this.removeNaLista(pos);
        }
      }
    }

    const lista = new LSE();
    const listContainer = document.getElementById('listContainer');

    function renderizarLista() {
      listContainer.innerHTML = '';
      let aux = lista.cabeca;
      while (aux !== null) {
        const listItem = document.createElement('div');
        listItem.className = 'list-item';
        listItem.textContent = aux.getConteudo();
        listContainer.appendChild(listItem);

        if (aux.getProx() !== null) {
          const arrow = document.createElement('span');
          arrow.className = 'arrow';
          arrow.textContent = '→';
          listContainer.appendChild(arrow);
        }

        aux = aux.getProx();
      }
    }

    function inserirElemento() {
      const pos = parseInt(prompt('Digite a posição de inserção:'));
      const valor = parseInt(prompt('Digite o valor a ser inserido:'));
      const sucesso = lista.insere(pos, valor);
      if (sucesso) {
        alert('Elemento inserido com sucesso!');
      }
      renderizarLista();
    }

    function removerElemento() {
      const pos = parseInt(prompt('Digite a posição de remoção:'));
      const valorRemovido = lista.remove(pos);
      if (valorRemovido !== -1) {
        alert(`Elemento ${valorRemovido} removido com sucesso!`);
      }
      renderizarLista();
    }

    function consultarPorValor() {
      const valor = parseInt(prompt('Digite o valor a ser consultado:'));
      const posicao = lista.posicao(valor);
      if (posicao !== -1) {
        alert(`O valor ${valor} está na posição ${posicao}`);
      }
    }

    function consultarPorPosicao() {
      const pos = parseInt(prompt('Digite a posição a ser consultada:'));
      const elemento = lista.elemento(pos);
      if (elemento !== -1) {
        alert(`O elemento na posição ${pos} é ${elemento}`);
      }
    }

    function inserirInicio() {
      const valor = parseInt(prompt('Digite o valor a ser inserido no início:'));
      const sucesso = lista.insereInicioLista(valor);
      if (sucesso) {
        alert('Elemento inserido no início com sucesso!');
      }
      renderizarLista();
    }

    function inserirFinal() {
      const valor = parseInt(prompt('Digite o valor a ser inserido no final:'));
      const sucesso = lista.insereFimLista(valor);
      if (sucesso) {
        alert('Elemento inserido no final com sucesso!');
      }
      renderizarLista();
    }

    function removerInicio() {
      const valorRemovido = lista.removeInicioLista();
      if (valorRemovido !== -1) {
        alert(`Elemento ${valorRemovido} removido do início com sucesso!`);
      }
      renderizarLista();
    }

    function removerFinal() {
      const valorRemovido = lista.removeFimLista();
      if (valorRemovido !== -1) {
        alert(`Elemento ${valorRemovido} removido do final com sucesso!`);
      }
      renderizarLista();
    }

    renderizarLista(); // Renderizar a lista inicial
  </script>
</body>
</html>
